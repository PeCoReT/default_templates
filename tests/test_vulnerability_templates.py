import unittest
import yaml
from pathlib import Path


class VulnerabilityTemplateTestCase(unittest.TestCase):
    def test_remediation(self):
        vulnerability_templates_path = Path(__file__).parent.parent / "vulnerability_templates"
        for path in vulnerability_templates_path.rglob("info.yaml"):
            with open(path, "r") as f:
                for item in yaml.safe_load(f):
                    for key in item.get('locale', {}).keys():
                        remediation = item["locale"][key].get('remediation')
                        if remediation:
                            print(item.get('id'))
                            self.assertEqual(remediation[-1], '.')
